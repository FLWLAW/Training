@page "/EmailReports"
@using Training.Website.Models

<table width="100%" style="background-color: lightgray;">
    <tr>
        <td class="HeaderClass" style="width: 100%;">
            <span class="HeaderClass">Session ID#</span>
            <br />
            <TelerikDropDownList
                Data="@_sessions"
                Value="_selectedSessionString"
                ValueChanged="@(async (string newValue) => await SessionChanged(newValue))"
                Enabled="true"
                Width="900px">
                <DropDownListSettings>
                    <DropDownListPopupSettings Height="180px" />
                </DropDownListSettings>
            </TelerikDropDownList>
        </td>
    </tr>
    @if (_dueDate != null)
    {
        <tr>
            <td style="text-align: center">
                Due Date: @_dueDate!.Value.ToShortDateString()
            </td>
        </tr>
    }
    <tr>
        <td style="text-align: center; background-color: white; padding-top: 6px; padding-bottom: 6px;">
            <TelerikButton Class="UniformButton"
                           OnClick="@(async() => await Globals.ExportToExcelFile(_emailedReports) )"
                           Enabled="true">
                EXPORT TO EXCEL
            </TelerikButton>
        </td>
    </tr>
    <tr>
        <td>
            <TelerikGrid
                @ref="@_emailedReports"
                Data="@_emailedUsers"
                Pageable="false" ScrollMode="GridScrollMode.Scrollable" Sortable="true" Resizable="true" Reorderable="false"
                Width="100%" Height="800px"
                FilterMode="@GridFilterMode.None" Groupable="false"
                SelectionMode="GridSelectionMode.None">
                <GridColumns>
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.Session_ID)" Title="Session ID" Width="90px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.FirstName)" Title="First Name" Width="90px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.LastName)" Title="Last Name" Width="120px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.Email)" Title="Email" Width="180px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.Role)" Title="Role" Width="90px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.Title)" Title="Title" Width="150px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.WhoFirstSent)" Title="First Sent By" Width="200px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.WhenFirstSent)" Title="When First Sent" Width="150px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.WhoLastUpdated)" Title="Last Updated By" Width="200px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.WhenLastUpdated)" Title="When Last Updated" Width="150px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.Status)" Title="Status" Width="105px" />
                    <GridColumn Field="@nameof(EMailReportBySessionIdModel.WhenUserLastSubmitted)" Title="When Last Submitted" Width="150px" />
                </GridColumns>
                <GridExport>
                    <GridExcelExport FileName="@Globals.ExportFilename("EmailedUsers_Session", _selectedSessionString)"
                                     AllPages="false" />
                </GridExport>
            </TelerikGrid>
        </td>
    </tr>
</table>


<style>
    span.HeaderClass {
        height: 30px;
    }

    td.HeaderClass {
        font-weight: 700;
    }

    .HeaderClassCentered {
        text-align: center;
    }
</style>
