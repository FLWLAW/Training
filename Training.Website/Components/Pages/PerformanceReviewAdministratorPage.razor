@page "/PerformanceReviewAdministratorPage"

@using Training.Website.Models
@using Training.Website.Models.Reviews;

<TelerikWindow 
    Modal="true"
    Visible="@_radioButtonScreenVisible"
    CloseOnOverlayClick="false"
    Left="0px"
    Width="1600px"
    Height="800px">
    <WindowContent>
        @if (_questionWithRadioButtonsToEdit != null)
        {
            <table style="width: 100%; height: 100%;">
                <tr>
                    <td style="width: 100%; text-align: center;">
                        <TelerikButton OnClick="@CloseRadioButtonEditScreen">Close</TelerikButton>
                    </td>
                </tr>
                <tr>
                    <td style="width: 100%; text-align: center; font-size: large; font-weight: 700;">
                        Adding/Editing Radio Button Choices for Question #@_questionWithRadioButtonsToEdit.QuestionNumber)&nbsp; @_questionWithRadioButtonsToEdit.Question
                    </td>
                </tr>
                <tr>
                    <td style="text-align: center;">
                        <TelerikGrid
                            @ref="@_radioButtonGrid_Active"
                            Data="@RadioButtonChoicesForScreen()"
                            Pageable="false" ScrollMode="GridScrollMode.Scrollable" Sortable="true" Resizable="true" Reorderable="false"
                            EditMode="GridEditMode.Incell"
                            OnUpdate="@RadioButtonUpdateHandler"
                            OnDelete="@RadioButtonDeleteHandler"
                            Width="1600px">
                            <GridColumns>
                                <GridColumn Field="@nameof(RadioChoiceModel.RadioChoice_ID)" Title="Radio Choice ID" Width="100px" Editable="false" />
                                <GridColumn Field="@nameof(RadioChoiceModel.ReviewQuestion_ID)" Title="Question ID" Width="100px" Editable="false" />
                                <GridColumn Field="@nameof(RadioChoiceModel.RadioChoice_Sequence)" Title="Sequence" Width="60px" Editable="false"/>
                                <GridColumn Field="@nameof(RadioChoiceModel.RadioChoice_Text)" Title="Text" Width="300px" Editable="true" />
                                <GridCommandColumn Width="180px">
                                    <GridCommandButton Command="Delete">Delete</GridCommandButton>
                                    <GridCommandButton Command="MoveUp" ShowInEdit="false" OnClick="@RadioButtonMoveUpHandler">Move Up</GridCommandButton>
                                    <GridCommandButton Command="MoveDown" ShowInEdit="false" OnClick="@RadioButtonMoveDownHandler">Move Down</GridCommandButton>
                                </GridCommandColumn>
                            </GridColumns>
                        </TelerikGrid>
                    </td>
                </tr>
            </table>
        }
    </WindowContent>
</TelerikWindow>


<!-- SELECT REVIEW YEAR -->
<table style="width: 100%; padding-top: 45px;">
    <tr>
        <td colspan="2" style="width: 100%; text-align: center;">
            <h3>Performance Review Administrator Page</h3>
        </td>
    </tr>
    <tr>
        <td style="width: 50%; text-align: right; padding-right: 6px; font-weight: 700;">
            Select Review Year:
        </td>
        <td style="width: 50%; text-align: left; padding-left: 6px;">
            <TelerikDropDownList Class="UniformWidth_DropDown"
                                 Width="200px"
                                 Data="_reviewYears"
                                 Enabled="true"
                                 ValueChanged="@(async (string newValue) => await ReviewYearChanged(newValue))">
                <DropDownListSettings>
                    <DropDownListPopupSettings Height="180px" />
                </DropDownListSettings>
            </TelerikDropDownList>
        </td>
    </tr>
</table>

@if (_selectedReviewYear != null)
{
    <table width="100%">
        <tr>
            <td style="width: 100%; text-align: center; padding-top: 60px; font-weight: 700;">
                Active Questions
            </td>
        </tr>
        <tr>
            <td style="width: 100%; text-align: center;">
                <TelerikGrid
                    Data="@_activeQuestions"
                    Pageable="false" ScrollMode="GridScrollMode.Scrollable" Sortable="true" Resizable="true" Reorderable="false"
                    Width="1600px"
                    EditMode="GridEditMode.Inline"
                    OnCancel="@ActiveQuestionCancelAllRadioChangesForOneQuestionHandler"
                    OnCreate="@ActiveQuestionCreateHandler"
                    OnDelete="@ActiveQuestionDeleteHandler"
                    OnUpdate="@ActiveQuestionUpdateHandler"
                    FilterMode="@GridFilterMode.None" Groupable="false"
                    SelectionMode="GridSelectionMode.None">
                    <GridToolBarTemplate>
                         <div class="center-toolbar-items">
                            <GridCommandButton Command="Add">Add New Question</GridCommandButton>
                        </div>
                    </GridToolBarTemplate>
                    <GridColumns>
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.Question_ID)" Title="Question ID" Width="60px" Editable="false" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.QuestionNumber)" Title="Question Number" Width="90px" Editable="false" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.Question)" Title="Question" Width="240px" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.AnswerFormat)" Title="Answer Format" Width="130px">
                            <Template>
                                @{
                                    var dataItem = (PerformanceReviewQuestionModel)context;
                                    @_answerFormats![dataItem.AnswerFormat!.Value]
                                }
                            </Template>
                            <EditorTemplate>
                                @{
                                    <TelerikDropDownList
                                        Data="@_answerFormats?.Values"
                                        @bind-Value="@_selectedAnswerFormatDropDownValue"
                                        Width="100%" />
                                }
                            </EditorTemplate>
                        </GridColumn>
                        <GridCommandColumn Width="180px">
                            <GridCommandButton Command="Edit">Edit</GridCommandButton>
                            <GridCommandButton Command="Save" ShowInEdit="true">Save</GridCommandButton>
                            <GridCommandButton Command="Cancel" ShowInEdit="true">Cancel</GridCommandButton>
                            <GridCommandButton Command="Delete">Delete</GridCommandButton>
                            <GridCommandButton Command="MoveUp" ShowInEdit="false" OnClick="@QuestionMoveUpHandler">Move Up</GridCommandButton>
                            <GridCommandButton Command="MoveDown" ShowInEdit="false" OnClick="@QuestionMoveDownHandler">Move Down</GridCommandButton>
                            <GridCommandButton Command="EditRadioButtons" ShowInEdit="true" Enabled="@EnableEditRadioButton(context)" OnClick="@UpdateRadioButtonClicked">Add/Edit Radio Buttons</GridCommandButton>
                        </GridCommandColumn>
                    </GridColumns>
                </TelerikGrid>
            </td>
        </tr>
        <tr>
            <td style="width: 100%; text-align: center; padding-top: 120px; font-weight: 700;">
                Deleted Questions
            </td>
        </tr>
        <tr>
            <td style="width: 100%; text-align: center;">
                <TelerikGrid Data="@_deletedQuestions"
                    Pageable="false" ScrollMode="GridScrollMode.Scrollable" Sortable="true" Resizable="true" Reorderable="false"
                    Width="1600px"
                    EditMode="GridEditMode.Inline"
                    FilterMode="@GridFilterMode.None" Groupable="false"
                    SelectionMode="GridSelectionMode.None">
                    <GridColumns>
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.Question_ID)" Title="Question ID" Width="60px" Editable="false" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.QuestionNumber)" Title="Question Number" Width="90px" Editable="false" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.Question)" Title="Question" Width="240px" />
                        <GridColumn Field="@nameof(PerformanceReviewQuestionModel.AnswerFormat)" Title="Answer Format" Width="130px">
                            <Template>
                                @{
                                    var dataItem = (PerformanceReviewQuestionModel)context;
                                    @_answerFormats![dataItem.AnswerFormat!.Value]
                                }
                            </Template>
                        </GridColumn>
                        <GridCommandColumn Width="180px">
                            <GridCommandButton Command="Restore" OnClick="@RestoreHandler">Restore</GridCommandButton>
                        </GridCommandColumn>
                    </GridColumns>
                </TelerikGrid>
            </td>
        </tr>
    </table>
}

<style>
    .center-toolbar-items {
        display: flex;
        justify-content: center; /* Centers items horizontally */
        align-items: center; /* Centers items vertically, if the toolbar has a specific height */
        width: 100%; /* Ensures the div takes the full width of the toolbar */
    }
</style>